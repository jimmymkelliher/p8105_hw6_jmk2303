P8105: Data Science I
================
Assignment 6<br>Jimmy Kelliher (UNI: jmk2303)

-   [Problem 1](#problem-1)

<!------------------------------------------------------------------------------
Preamble
------------------------------------------------------------------------------->
<!------------------------------------------------------------------------------
Problem 1
------------------------------------------------------------------------------->

# Problem 1

``` r
birthweight <-
  read_csv("./datasets/birthweight.csv") %>%
  mutate(
    babysex = factor(recode(
      babysex
    , `1` = "Male"
    , `2` = "Female"
    ))
    # recode mrace as a factor variable
  , mrace = factor(recode(
      mrace
    , `1` = "White"
    , `2` = "Black"
    , `3` = "Asian"
    , `4` = "Puerto Rican"
    , `8` = "Other"
    ))
    # recode frace as a factor variable, noting it has an additional level
  , frace = factor(recode(
      frace
    , `1` = "White"
    , `2` = "Black"
    , `3` = "Asian"
    , `4` = "Puerto Rican"
    , `8` = "Other"
    , `9` = "Unknown"
    ))
    # recode malform as a factor variable
  , malform = factor(recode(
      malform
    , `0` = "Absent"
    , `1` = "Present"
    ))
    # about 92% of observations are either black couples or white couples
    # as such, we create a more parsimonious factor variable to capture this
  , prace = factor(
      ifelse((mrace == "Black" & frace == "Black"), "Black",
      ifelse((mrace == "White" & frace == "White"), "White", "Other"))
    )
  )
```

We first observe that the variables `pnumlbw` and `pnumsga` consist
solely of zeroes. As they offer no variation, they are not suitable for
prediction in this dataset, so we will omit them from our analysis.

``` r
# show that pnumlbw is always zero
all(pull(birthweight, pnumlbw) == 0)
```

    ## [1] TRUE

``` r
# show that pnumsga is always zero
all(pull(birthweight, pnumsga) == 0)
```

    ## [1] TRUE

``` r
summary(lm(
  bwt ~ 
    #delwt    omitted since wtgain = delwt - ppwt
  + fincome
  + wtgain
  #+ mrace
  #+ frace
  #+ mrace * frace
  + prace
  + gaweeks
  #+ malform
  + menarche
  + mheight
  + momage
  + parity
  #+ pnumlbw    all enttries 0
  #+ pnumsga    all enttries 0
  + ppbmi
  + ppwt
  + smoken
  # baby variables
  #+ babysex
  #+ bhead
  + blength
  , data = birthweight
))
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ +fincome + wtgain + prace + gaweeks + menarche + 
    ##     mheight + momage + parity + ppbmi + ppwt + smoken + blength, 
    ##     data = birthweight)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -1649.4  -204.8    -6.9   197.2  3715.7 
    ## 
    ## Coefficients:
    ##               Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) -5333.9746   760.2130  -7.016 2.63e-12 ***
    ## fincome         0.5186     0.2070   2.505  0.01228 *  
    ## wtgain          5.3964     0.4535  11.899  < 2e-16 ***
    ## praceOther     88.6325    18.8291   4.707 2.59e-06 ***
    ## praceWhite    170.2971    11.8553  14.365  < 2e-16 ***
    ## gaweeks        22.6256     1.6510  13.704  < 2e-16 ***
    ## menarche       -1.4532     3.3377  -0.435  0.66331    
    ## mheight        20.9369    11.8870   1.761  0.07825 .  
    ## momage          1.3423     1.3949   0.962  0.33596    
    ## parity        121.1220    46.6890   2.594  0.00951 ** 
    ## ppbmi          21.6271    17.1619   1.260  0.20767    
    ## ppwt           -1.6762     2.9781  -0.563  0.57356    
    ## smoken         -6.2625     0.6740  -9.292  < 2e-16 ***
    ## blength       115.6280     1.9702  58.688  < 2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 314.5 on 4328 degrees of freedom
    ## Multiple R-squared:  0.6241, Adjusted R-squared:  0.623 
    ## F-statistic: 552.8 on 13 and 4328 DF,  p-value: < 2.2e-16

``` r
y <- pull(birthweight, bwt)
X <-
  birthweight %>%
  select(
    fincome, wtgain, mrace, frace, gaweeks, malform, menarche,
    mheight, momage, parity, ppbmi, ppwt, smoken, delwt,
    # baby variables
    babysex, bhead, blength
  )

#cv_model <- glmnet::cv.glmnet(as.matrix(X), y, alpha = 1)

# find optimal lambda value that minimizes test MSE
#best_lambda <- cv_model$lambda.min
#best_lambda
```
